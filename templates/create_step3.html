{% extends "base.html" %}

{% block title %}Step 3: Deploy - RAG Chatbot Platform{% endblock %}

{% block content %}
<div class="wizard-container">
    <div class="container">
        <!-- Step Indicator -->
        <div class="step-indicator">
            <div class="step completed">
                <div class="step-number">‚úì</div>
                <div class="step-label">Data</div>
            </div>
            <div class="step-line completed"></div>
            <div class="step completed">
                <div class="step-number">‚úì</div>
                <div class="step-label">Playground</div>
            </div>
            <div class="step-line completed"></div>
            <div class="step active">
                <div class="step-number">3</div>
                <div class="step-label">Deploy</div>
            </div>
        </div>

        <!-- Form Content -->
        <div class="wizard-content">
            <h1>Step 3: Deploy</h1>
            <p class="wizard-description">Deploy your chatbot and get the URL to share with others</p>

            <!-- Deployment Section (shown before deployment) -->
            <div id="deploy-section" class="deployment-section">
                <div class="deployment-summary">
                    <h3>Deployment Summary</h3>
                    <div class="summary-item">
                        <span class="summary-label">Chatbot Name:</span>
                        <span class="summary-value" id="summary-name"></span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Model:</span>
                        <span class="summary-value" id="summary-model"></span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Documents:</span>
                        <span class="summary-value" id="summary-documents"></span>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="back-btn">‚Üê Back to Playground</button>
                    <button type="button" class="btn-primary" id="deploy-btn">Deploy Chatbot</button>
                </div>

                <div id="deploy-progress" class="deploy-progress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <p class="progress-text" id="progress-text">Deploying chatbot...</p>
                </div>

                <div id="deploy-error" class="error-message" style="display: none;"></div>
            </div>

            <!-- Success Section (shown after deployment) -->
            <div id="success-section" class="deployment-info" style="display: none;">
                <div class="success-icon">üéâ</div>
                <h2>Your Chatbot is Ready!</h2>
                <p class="wizard-description">Your chatbot has been successfully deployed and is ready to use</p>

                <div class="info-card">
                    <h3>Chatbot Details</h3>
                    <div class="info-row">
                        <span class="info-label">Name:</span>
                        <span class="info-value" id="chatbot-name-display"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Model:</span>
                        <span class="info-value" id="model-display"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Documents:</span>
                        <span class="info-value" id="document-count"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Status:</span>
                        <span class="info-value status-ready">Ready</span>
                    </div>
                </div>

                <div class="info-card">
                    <h3>Access Your Chatbot</h3>
                    <div class="chatbot-url-container">
                        <input
                            type="text"
                            id="chatbot-url"
                            readonly
                            class="url-input"
                        >
                        <button type="button" class="btn-copy" id="copy-url-btn">
                            Copy URL
                        </button>
                    </div>
                    <p class="url-hint">Share this URL to let others use your chatbot</p>
                </div>

                <div class="form-actions">
                    <a href="/dashboard" class="btn-secondary">View All Chatbots</a>
                    <a href="/create" class="btn-secondary">Create Another</a>
                    <button type="button" class="btn-primary" id="open-chat-btn">Open Chatbot</button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/wizard_step3.js') }}"></script>
{% endblock %}
